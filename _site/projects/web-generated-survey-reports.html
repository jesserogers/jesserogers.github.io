<!DOCTYPE html>
<html>
  <head>
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="description" content="A JavaScript object oriented approach to generate survey reports out of JSON data.">
    
    <meta name="author" content="Jesse Rogers">
    <title>Web Generated Survey Reports / Jesse Rogers - Seattle Designer, Photographer, Web Developer</title>
    <link rel="icon" href="/assets/img/favicon.ico">
    <link href="https://fonts.googleapis.com/css?family=Poppins:400,700" rel="stylesheet">
    <link rel="stylesheet" href="/assets/css/style.css?v=17486052c75aa9ca91bb2f5f0bdf18f14be6d3d6">
  </head>
  <body>
    <nav class="main-nav">
      <a class="logo" href="/">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 216 216">
    <defs>
        <style>
            .jesse-rogers-1 {
                fill: #fceb5e;
            }
            .jesse-rogers-2 {
                fill: #222;
            }
        </style>
    </defs>
    <title>Jesse Rogers - Seattle based designer, photographer, web developer, animator, illustrator, and videographer</title>
    <g id="Layer_2" data-name="Layer 2">
        <g id="Layer_1-2" data-name="Layer 1"><polygon class="jesse-rogers-1" points="216 216 144 144 72 144 72 216 216 216"/><path class="jesse-rogers-1" d="M72,0h72a72,72,0,0,1,72,72v0a72,72,0,0,1-72,72H72a0,0,0,0,1,0,0V0A0,0,0,0,1,72,0Z"/><path class="jesse-rogers-2" d="M72,0V144H0a72,72,0,0,0,72,72h0a72,72,0,0,0,72-72V0Z"/></g>
    </g>
</svg>

      </a>
      <div class="js-nav-trigger">
        <span></span>
        <span></span>
      </div>
      <ul class="nav-items">
        <li class="nav-item">
          <a href="/projects/" title="Projects">Projects</a>
        </li>
        <li class="nav-item has-subnav">
          <a href="javascript:void(0);">Quick Portfolios</a>
          <ul class="subnav" style="display: none;">
            <li class="subnav-item">
              <a href="/photography/" title="Photography">Photography</a>
            </li>
            <li class="subnav-item">
              <a href="/design/" title="Photography">Design</a>
            </li>
            <li class="subnav-item">
              <a href="/motion/" title="Photography">Motion</a>
            </li>
          </ul>
        </li>
        <li class="nav-item">
          <a href="/journal/" title="Journal">Journal</a>
        </li>
        <li class="nav-item">
          <a href="/about/" title="About me">About</a>
        </li>
        <li class="nav-item">
          <a href="/contact/" title="Contact">Contact</a>
        </li>
      </ul>
    </nav>
    <section class="page-header">
  <div class="content">
    <h1>Web Generated Survey Reports</h1>
    <p>A JavaScript object oriented approach to generate survey reports out of JSON data.</p>
  </div>
</section>
<section class="project-content">
  <div class="content">
    <p>One of my least favorite things to do at work is create survey reports.</p>

<p>Adaptiva does a big survey or two every year on topics like Windows 10 or buzzworthy security topics, and once all the data has been reviewed and written about, I’m supposed to turn it into a pretty, branded document.</p>

<p><em>Oh my god it’s so tedious</em>.</p>

<p>I ended up building these documents in Apple Pages/Numbers because I found it more intuitive than Microsoft Word/Excel. Either way, it <em>sucked</em> and I was really starting to dread doing this.</p>

<p>Our latest Windows 10 survey report released today, and I’m happy to say it’s all in the web now, generated by a reusable JavaScript object-driven system.</p>

<h2 id="structuring-the-objects">Structuring the Objects</h2>

<p>Our surveys all have the same structure: each question in the survey has a title, a key takeaway, an excerpt, and the data in graph and table format.</p>

<p>There’s also a total number of responses for each question. Because some questions are “check all that apply,” it’s important to have a predefined total to divide against, rather than dividing against the total of all responses.</p>

<p>This makes it really easy to store the data to populate the survey in simple JSON. An array of objects with properties to match: <code class="highlighter-rouge">title</code>, <code class="highlighter-rouge">takeaway</code>, and <code class="highlighter-rouge">excerpt</code> are all strings. <code class="highlighter-rouge">total</code> is a number, and <code class="highlighter-rouge">data</code> is an object with the properties <code class="highlighter-rouge">answer</code>, a string for the answer option, and <code class="highlighter-rouge">count</code>, a number representing the number of people who selected that <code class="highlighter-rouge">answer</code>.</p>

<p>Here’s an example:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">title</span><span class="p">:</span> <span class="s1">'How long do you estimate it will take to migrate your entire organization to Windows 10?'</span><span class="p">,</span>
  <span class="nx">takeaway</span><span class="p">:</span> <span class="s1">'Most companies expect to complete their migrations in the next 12 months.'</span><span class="p">,</span>
  <span class="nx">excerpt</span><span class="p">:</span> <span class="s1">'Forty percent of respondents suggested their company will complete their Windows 10 migration in six months or less. Another 21% expect it to take a full year. Over a third (39%) plan to take more than a year to move all their systems to the new OS.'</span><span class="p">,</span>
  <span class="nx">responses</span><span class="p">:</span> <span class="mi">420</span><span class="p">,</span>
  <span class="nx">data</span><span class="p">:</span> <span class="p">{</span>
    <span class="nl">opt1</span><span class="p">:</span> <span class="p">{</span>
      <span class="nl">answer</span><span class="p">:</span> <span class="s1">'1 month or less'</span><span class="p">,</span>
      <span class="nx">count</span><span class="p">:</span> <span class="mi">45</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="nx">opt2</span><span class="p">:</span> <span class="p">{</span>
      <span class="nl">answer</span><span class="p">:</span> <span class="s1">'2-3 months'</span><span class="p">,</span>
      <span class="nx">count</span><span class="p">:</span> <span class="mi">55</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="nx">opt3</span><span class="p">:</span> <span class="p">{</span>
      <span class="nl">answer</span><span class="p">:</span> <span class="s1">'4-6 months'</span><span class="p">,</span>
      <span class="nx">count</span><span class="p">:</span> <span class="mi">65</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="nx">opt4</span><span class="p">:</span> <span class="p">{</span>
      <span class="nl">answer</span><span class="p">:</span> <span class="s1">'7-12 months'</span><span class="p">,</span>
      <span class="nx">count</span><span class="p">:</span> <span class="mi">90</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="nx">opt5</span><span class="p">:</span> <span class="p">{</span>
      <span class="nl">answer</span><span class="p">:</span> <span class="s1">'More than 1 year'</span><span class="p">,</span>
      <span class="nx">count</span><span class="p">:</span> <span class="mi">165</span><span class="p">,</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>
<h2 id="object-properties-and-methods">Object Properties and Methods</h2>

<p>The object constructor function takes in the parameteres <code class="highlighter-rouge">title</code>, <code class="highlighter-rouge">takeaway</code>, <code class="highlighter-rouge">excerpt</code>, <code class="highlighter-rouge">total</code>, and <code class="highlighter-rouge">data</code>.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">Graph</span><span class="p">(</span><span class="nx">title</span><span class="p">,</span> <span class="nx">takeaway</span><span class="p">,</span> <span class="nx">excerpt</span><span class="p">,</span> <span class="nx">total</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">$this</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
  <span class="nx">$this</span><span class="p">.</span><span class="nx">title</span> <span class="o">=</span> <span class="nx">title</span><span class="p">;</span>
  <span class="nx">$this</span><span class="p">.</span><span class="nx">takeaway</span> <span class="o">=</span> <span class="nx">takeaway</span><span class="p">;</span>
  <span class="nx">$this</span><span class="p">.</span><span class="nx">excerpt</span> <span class="o">=</span> <span class="nx">excerpt</span><span class="p">;</span>
  <span class="nx">$this</span><span class="p">.</span><span class="nx">totalResponses</span> <span class="o">=</span> <span class="nx">total</span><span class="p">;</span>
  <span class="nx">$this</span><span class="p">.</span><span class="nx">data</span> <span class="o">=</span> <span class="nx">data</span><span class="p">;</span>
  <span class="c1">// ...  </span>
<span class="p">}</span>
</code></pre></div></div>
<p>I created DOM nodes to be used to render the Graph.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">question</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">'&lt;div&gt;&lt;/div&gt;'</span><span class="p">),</span>
<span class="nx">graph</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">'&lt;div&gt;&lt;/div&gt;'</span><span class="p">),</span>
<span class="nx">table</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">'&lt;div&gt;&lt;/div&gt;'</span><span class="p">),</span>
<span class="nx">totalResp</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">'&lt;div&gt;&lt;/div&gt;'</span><span class="p">);</span>
</code></pre></div></div>
<p>Then, I created a method on the Graph object called <code class="highlighter-rouge">_render()</code>. First, we configure the DOM nodes.</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">$this</span><span class="p">.</span><span class="nx">_render</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// set a flag for if any values in the graph are &gt; 50%</span>
  <span class="kd">var</span> <span class="nx">over50</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
  <span class="nx">graph</span><span class="p">.</span><span class="nx">addClass</span><span class="p">(</span><span class="s1">'question-graph'</span><span class="p">);</span>

  <span class="nx">table</span>
  <span class="p">.</span><span class="nx">addClass</span><span class="p">(</span><span class="s1">'question-table'</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="s1">'&lt;div class="j-row question-table-header"&gt;'</span> <span class="o">+</span> <span class="s1">'&lt;div class="j-col j-col-8"&gt;&lt;h4 class="white"&gt;Answer Choices&lt;/h4&gt;&lt;/div&gt;'</span> <span class="o">+</span> <span class="s1">'&lt;div class="j-col j-col-4"&gt;&lt;h4 class="white"&gt;Responses&lt;/h4&gt;&lt;/div&gt;'</span> <span class="o">+</span> <span class="s1">'&lt;/div&gt;'</span> <span class="o">+</span> <span class="s1">'&lt;div class="j-row question-table-content"&gt;&lt;/div&gt;'</span><span class="p">);</span>

  <span class="nx">question</span><span class="p">.</span><span class="nx">attr</span><span class="p">({</span>
    <span class="s1">'class'</span><span class="p">:</span> <span class="s1">'question collapsible-section js-scroll'</span><span class="p">,</span>
    <span class="s1">'id'</span><span class="p">:</span> <span class="s1">'question-'</span> <span class="o">+</span> <span class="p">(</span><span class="nx">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
  <span class="p">})</span>
  <span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="s1">'&lt;h2 class="question-title blue collapsible-title is-expanded"&gt;'</span> <span class="o">+</span> <span class="nx">$this</span><span class="p">.</span><span class="nx">title</span> <span class="o">+</span> <span class="s1">'&lt;/h2&gt;'</span> <span class="o">+</span> <span class="s1">'&lt;div class="collapsible-section--content is-expanded"&gt;'</span> <span class="o">+</span> <span class="s1">'&lt;div class="question-takeaway"&gt;&lt;strong&gt;Takeaway: '</span> <span class="o">+</span> <span class="nx">$this</span><span class="p">.</span><span class="nx">takeaway</span> <span class="o">+</span> <span class="s1">'&lt;/strong&gt;&lt;/div&gt;'</span> <span class="o">+</span> <span class="s1">'&lt;p class="question-excerpt"&gt;'</span> <span class="o">+</span> <span class="nx">$this</span><span class="p">.</span><span class="nx">excerpt</span> <span class="o">+</span> <span class="s1">'&lt;/p&gt;'</span> <span class="o">+</span> <span class="s1">'&lt;/div&gt;'</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">appendTo</span><span class="p">(</span><span class="s1">'.survey-container'</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">'.question-excerpt'</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">before</span><span class="p">(</span><span class="nx">graph</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">after</span><span class="p">(</span><span class="nx">table</span><span class="p">);</span>
  <span class="c1">// ...</span>
<span class="p">}</span>
</code></pre></div></div>
<h2 id="populating-data-and-making-it-look-good">Populating Data and Making it Look Good</h2>
<p>Cool. Next, to populate the graph and table. I looped through the <code class="highlighter-rouge">data</code> object and added rows to the graph and table for each entry inside <code class="highlighter-rouge">data</code>.</p>

<p>Since we’re always working with bar graphs that are percentage based, I can create simple <code class="highlighter-rouge">div</code> elements with a height and background color, then apply the percentage value from the data directly to the <code class="highlighter-rouge">width</code> property inline.</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// first check to see if ANY values are &gt; 50%</span>
<span class="k">for</span> <span class="p">(</span><span class="nx">response</span> <span class="k">in</span> <span class="nx">$this</span><span class="p">.</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">((</span><span class="nx">$this</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="nx">response</span><span class="p">].</span><span class="nx">count</span> <span class="o">/</span> <span class="nx">$this</span><span class="p">.</span><span class="nx">totalResponses</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">50</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// if so, set flag to true</span>
    <span class="nx">over50</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="k">for</span> <span class="p">(</span><span class="nx">response</span> <span class="k">in</span> <span class="nx">$this</span><span class="p">.</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span>
  <span class="nx">graphRow</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">'&lt;div&gt;&lt;/div&gt;'</span><span class="p">),</span>
  <span class="nx">graphBar</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">'&lt;div&gt;&lt;/div&gt;'</span><span class="p">),</span>
  <span class="nx">tableContent</span> <span class="o">=</span> <span class="nx">table</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">'.question-table-content'</span><span class="p">),</span>
  <span class="nx">tableRow</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">'&lt;div&gt;&lt;/div&gt;'</span><span class="p">),</span>
  <span class="nx">percentage</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">(((</span><span class="nx">$this</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="nx">response</span><span class="p">].</span><span class="nx">count</span> <span class="o">/</span> <span class="nx">$this</span><span class="p">.</span><span class="nx">totalResponses</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.00001</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span><span class="p">;</span>

  <span class="nx">graphRow</span><span class="p">.</span><span class="nx">attr</span><span class="p">({</span>
    <span class="s1">'class'</span><span class="p">:</span> <span class="s1">'j-row question-graph-row'</span><span class="p">,</span>
    <span class="s1">'data-percent'</span><span class="p">:</span> <span class="nx">percentage</span><span class="p">,</span>
  <span class="p">})</span>
  <span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="s1">'&lt;div class="j-col j-col-3 question-graph-label"&gt;&lt;span&gt;'</span> <span class="o">+</span> <span class="nx">$this</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="nx">response</span><span class="p">].</span><span class="nx">answer</span> <span class="o">+</span> <span class="s1">'&lt;/span&gt;&lt;/div&gt;'</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">appendTo</span><span class="p">(</span><span class="nx">graph</span><span class="p">);</span>

  <span class="nx">graphBar</span><span class="p">.</span><span class="nx">attr</span><span class="p">({</span>
    <span class="s1">'class'</span><span class="p">:</span> <span class="s1">'question-graph-bar j-col j-col-9'</span>
  <span class="p">});</span>

  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">over50</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// if no values &gt; 50%</span>
    <span class="c1">// multiply widths of all graph bars by 2 for ~*aesthetics*~</span>
    <span class="nx">graphBar</span>
    <span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="s1">'&lt;div class="question-graph-bar-data" style="width:'</span> <span class="o">+</span> <span class="p">(</span><span class="nx">percentage</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'%; max-width: 0;" title="'</span> <span class="o">+</span> <span class="nx">$this</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="nx">response</span><span class="p">].</span><span class="nx">answer</span> <span class="o">+</span> <span class="s1">' - '</span> <span class="o">+</span> <span class="nx">percentage</span> <span class="o">+</span> <span class="s1">'%"&gt;&lt;/div&gt;'</span> <span class="o">+</span> <span class="s1">'&lt;span class="gray type-small"&gt;'</span> <span class="o">+</span> <span class="nx">percentage</span> <span class="o">+</span> <span class="s1">'%&lt;/span&gt;'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">appendTo</span><span class="p">(</span><span class="nx">graphRow</span><span class="p">);</span>

  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="c1">// else just match width to percentage value</span>
    <span class="nx">graphBar</span>
    <span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="s1">'&lt;div class="question-graph-bar-data" style="width:'</span> <span class="o">+</span> <span class="nx">percentage</span> <span class="o">+</span> <span class="s1">'%; max-width: 0;" title="'</span> <span class="o">+</span> <span class="nx">$this</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="nx">response</span><span class="p">].</span><span class="nx">answer</span> <span class="o">+</span> <span class="s1">' - '</span> <span class="o">+</span> <span class="nx">percentage</span> <span class="o">+</span> <span class="s1">'%"&gt;&lt;/div&gt;'</span> <span class="o">+</span> <span class="s1">'&lt;span class="gray type-small"&gt;'</span> <span class="o">+</span> <span class="nx">percentage</span> <span class="o">+</span> <span class="s1">'%&lt;/span&gt;'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">appendTo</span><span class="p">(</span><span class="nx">graphRow</span><span class="p">);</span>

  <span class="p">}</span>

  <span class="nx">tableRow</span><span class="p">.</span><span class="nx">attr</span><span class="p">({</span>
    <span class="s1">'class'</span><span class="p">:</span> <span class="s1">'j-row question-table-row'</span><span class="p">,</span>
    <span class="c1">// add percentage value for sorting</span>
    <span class="s1">'data-percent'</span><span class="p">:</span> <span class="nx">percentage</span><span class="p">,</span>
  <span class="p">})</span>
  <span class="c1">// add data to table row and add to table</span>
  <span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="s1">'&lt;div class="j-col j-col-8 question-table-option" data-th="Answer"&gt;&lt;span&gt;'</span> <span class="o">+</span> <span class="nx">$this</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="nx">response</span><span class="p">].</span><span class="nx">answer</span> <span class="o">+</span> <span class="s1">'&lt;/span&gt;&lt;/div&gt;'</span> <span class="o">+</span> <span class="s1">'&lt;div class="j-col j-col-2 question-table-percent" data-th="Response"&gt;&lt;span&gt;'</span> <span class="o">+</span> <span class="nx">percentage</span> <span class="o">+</span> <span class="s1">'%&lt;/span&gt;&lt;/div&gt;'</span> <span class="o">+</span> <span class="s1">'&lt;div class="j-col j-col-2 question-table-count" data-th="Response Count"&gt;&lt;span&gt;'</span> <span class="o">+</span> <span class="nx">$this</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="nx">response</span><span class="p">].</span><span class="nx">count</span> <span class="o">+</span> <span class="s1">'&lt;/span&gt;&lt;/div&gt;'</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">appendTo</span><span class="p">(</span><span class="nx">tableContent</span><span class="p">);</span>

<span class="p">}</span> <span class="c1">// end loop</span>

<span class="c1">// add total responses at bottom of table</span>
<span class="nx">totalResp</span><span class="p">.</span><span class="nx">attr</span><span class="p">({</span>
  <span class="s1">'class'</span><span class="p">:</span> <span class="s1">'j-row'</span>
<span class="p">})</span>
<span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="s1">'&lt;h4 class="j-col j-col-8 black question-table-total"&gt;Total&lt;/h4&gt;'</span> <span class="o">+</span> <span class="s1">'&lt;div class="j-col j-col-4 question-table-count" data-th="Total Respondents"&gt;&lt;span&gt;'</span> <span class="o">+</span> <span class="nx">$this</span><span class="p">.</span><span class="nx">totalResponses</span> <span class="o">+</span> <span class="s1">'&lt;/span&gt;&lt;/div&gt;'</span><span class="p">)</span>
<span class="p">.</span><span class="nx">appendTo</span><span class="p">(</span><span class="nx">table</span><span class="p">);</span>
</code></pre></div></div>
<p>Some questions required the graph and table to be sorted by response in descending order, so I created a function expression called <code class="highlighter-rouge">sortData()</code> to handle that.</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">sortData</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Sorting data for Question #'</span> <span class="o">+</span> <span class="p">(</span><span class="nx">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">));</span>
  <span class="kd">var</span>
  <span class="nx">sortedQuestion</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">'#question-'</span> <span class="o">+</span> <span class="p">(</span><span class="nx">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)),</span>
  <span class="nx">sortedGraph</span> <span class="o">=</span> <span class="nx">sortedQuestion</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">'.question-graph'</span><span class="p">),</span>
  <span class="nx">sortedTable</span> <span class="o">=</span> <span class="nx">sortedQuestion</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">'.question-table-content'</span><span class="p">);</span>

  <span class="nx">sortedGraph</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">'.question-graph-row'</span><span class="p">).</span><span class="nx">sort</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="nx">a</span><span class="p">).</span><span class="nx">data</span><span class="p">(</span><span class="s1">'percent'</span><span class="p">))</span> <span class="o">&lt;</span> <span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="nx">b</span><span class="p">).</span><span class="nx">data</span><span class="p">(</span><span class="s1">'percent'</span><span class="p">))</span> <span class="p">?</span> <span class="mi">1</span> <span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
  <span class="p">}).</span><span class="nx">appendTo</span><span class="p">(</span><span class="nx">sortedGraph</span><span class="p">);</span>

  <span class="nx">sortedTable</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">'.question-table-row'</span><span class="p">).</span><span class="nx">sort</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="nx">a</span><span class="p">).</span><span class="nx">data</span><span class="p">(</span><span class="s1">'percent'</span><span class="p">))</span> <span class="o">&lt;</span> <span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="nx">b</span><span class="p">).</span><span class="nx">data</span><span class="p">(</span><span class="s1">'percent'</span><span class="p">))</span> <span class="p">?</span> <span class="mi">1</span> <span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
  <span class="p">}).</span><span class="nx">appendTo</span><span class="p">(</span><span class="nx">sortedTable</span><span class="p">);</span>
<span class="p">};</span>
</code></pre></div></div>
<p>Nice! Now everything is in place to actually put the data on the page. All the JSON data is stored in a global array called <code class="highlighter-rouge">questions</code>, so all I have to do is loop through that array and construct a new <code class="highlighter-rouge">Graph</code> using each object’s properties as the parameters for the constructor.</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">$</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">questions</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// create new Graph object for each question</span>
  <span class="nx">questions</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Graph</span><span class="p">(</span>
    <span class="nx">questions</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">title</span><span class="p">,</span>
    <span class="nx">questions</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">takeaway</span><span class="p">,</span>
    <span class="nx">questions</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">excerpt</span><span class="p">,</span>
    <span class="nx">questions</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">responses</span><span class="p">,</span>
    <span class="nx">questions</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">data</span>
  <span class="p">);</span>
  <span class="c1">// render graph on page</span>
  <span class="nx">questions</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">_render</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
  <span class="c1">// sort questions that need sorting</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">questions</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="s1">'sorted'</span><span class="p">))</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Question #'</span> <span class="o">+</span> <span class="p">(</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">' flagged for sorting'</span><span class="p">);</span>
    <span class="nx">sortData</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre></div></div>
<p>Easy. And it renders on the page like so.</p>
<div class="callout">
<div class="callout-content">
<div class="j-col j-col-9">
<img src="/assets/img/projects/web-generated-survey-question.png" alt="Javascript object generated survey graph" />
</div>
<div class="j-col j-col-3">
<img src="/assets/img/projects/web-generated-survey-question-mobile.png" alt="Javascript object generated survey graph" />
</div>
</div>
</div>

<h2 id="user-experience-time">User Experience Time</h2>

<p>I decided to make each question/graph collapsible to allow the user to digest information in a more focused manner, if they want. Users can click on the title of the question to toggle expansion.</p>

<div class="callout">
<div class="callout-content">
<div class="j-col j-col-12">
<img src="/assets/img/projects/web-generated-survey-collapsed.png" alt="Javascript object generated survey graph" />
</div>
</div>
</div>

<p>I took it one step further and made a Google-esque menu that comes out of a little circle stuck in the bottom right corner of the screen. Thanks for the inspo, Google Inbox.</p>

<p>The circle with the dots has a nice little hover animation, and the dots animate into an ‘X’ on click to indicate that the menu can be toggled out. Opening the menu brings up a white gradient on the screen to draw attention to the menu items and help with legibility.</p>

<div class="callout">
<div class="callout-content">
<div class="j-col j-col-9">
<img src="/assets/img/projects/web-generated-survey-menu.png" alt="Javascript object generated survey graph" />
</div>
<div class="j-col j-col-3">
<img src="/assets/img/projects/web-generated-survey-menu-mobile.png" alt="Javascript object generated survey graph" />
</div>
</div>
</div>

<p>The menu allows the user to quickly scroll back to the top of the page, collapse all questions, or expand all questions.</p>

<h2 id="thank-god-no-more-manual-design">Thank God, No More Manual Design</h2>

<p>There’s a little more to this, like animations and a little DOM manipulation, but this is all that I found interesting enough to write about.</p>

<p>I probably spent like a day and a half from start to finish on coding this. Manually designing survey reports in productivity software like Word or Pages took about a full day, assuming we didn’t have to scrap parts of it to make drastic copy changes, which can extend the time frame to hilarious measures.</p>

<p>Writing simple JSON to run all this code and generate this report took about 20 minutes, and making changes is remarkably easy and low impact.</p>

<p>Not only will this system save significant time in the future, but I believe it provides a vastly superior experience to a static PDF, especially on mobile devices.</p>

<p>Check out the live survey <a href="http://www2.adaptiva.com/downloads/surveys/2018-windows-10-enterprise-impact">here</a>.</p>

<p>Thanks for reading,
<strong>Jesse</strong></p>

  </div>
</section>
<section class="post-nav">
  <div class="content">
    
    
    
    
      
        
        
    
      
        
          
          
          
    
        <a class="post-nav-link previous" href="/projects/destiny-2-clan-website"><div class="post-nav-arrow">&#x279E;</div> &nbsp; Destiny 2 Clan Website</a>
      
    
        <a class="post-nav-link next" href=""> &nbsp; <div class="post-nav-arrow">&#x279E;</div></a>
      
</div>
</section>

    <footer class="footer">
      <div class="content">
        <div class="j-col j-col-6 copyright">
            All content ©<script>new Date().getFullYear()>2010&&document.write(new Date().getFullYear());</script> Jesse Rogers. All rights reserved.<br>
            <span style="color:#999;">This website lovingly designed and developed by hand by yours truly.</span>
        </div>
        <div class="j-col j-col-6 social">
          <a class="social-icon" href="https://twitter.com/jesserogers" target="_blank" rel="noopener">Twitter</a>
          <a class="social-icon" href="https://instagram.com/jssrgrs" target="_blank" rel="noopener">Instagram</a>
          <a class="social-icon" href="https://dribbble.com/jesserogers" target="_blank" rel="noopener">Dribbble</a>
          <a class="social-icon" href="https://youtube.com/JesseRogersTV" target="_blank" rel="noopener">YouTube</a>
        </div>
      </div>
    </footer>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    
    <script type="text/javascript" src="/assets/js/touchswipe.js"></script>
    <script type="text/javascript" src="/assets/js/main.js"></script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-28353492-1', 'auto');
      ga('send', 'pageview');

    </script>
  </body>
</html>
